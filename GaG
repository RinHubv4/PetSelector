--// Services
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

--// ScreenGui
local gui = Instance.new("ScreenGui")
gui.Name = "RinTradeUI_V2"
gui.ResetOnSpawn = false
gui.Parent = playerGui

--// Main Card
local main = Instance.new("Frame")
main.Size = UDim2.new(0, 260, 0, 200)
main.Position = UDim2.new(0.5, -130, 0.5, -100)
main.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
main.BorderSizePixel = 0
main.Active = true
main.Draggable = true
main.Parent = gui

Instance.new("UICorner", main).CornerRadius = UDim.new(0, 16)

--// Header
local header = Instance.new("TextLabel")
header.Size = UDim2.new(1, 0, 0, 36)
header.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
header.Text = "âš¡ Rin Trade Helper"
header.Font = Enum.Font.GothamBold
header.TextSize = 16
header.TextColor3 = Color3.fromRGB(255,255,255)
header.Parent = main
Instance.new("UICorner", header).CornerRadius = UDim.new(0, 16)

--// Status
local status = Instance.new("TextLabel")
status.Position = UDim2.new(0, 16, 0, 44)
status.Size = UDim2.new(1, -32, 0, 22)
status.BackgroundTransparency = 1
status.Text = "Status: Not in trade"
status.Font = Enum.Font.Gotham
status.TextSize = 14
status.TextXAlignment = Left
status.TextColor3 = Color3.fromRGB(200,200,200)
status.Parent = main

--// Toggle Container
local container = Instance.new("Frame")
container.Position = UDim2.new(0, 16, 0, 76)
container.Size = UDim2.new(1, -32, 1, -96)
container.BackgroundTransparency = 1
container.Parent = main

local layout = Instance.new("UIListLayout", container)
layout.Padding = UDim.new(0, 10)

--// Trade Check
local function checkTradeStatus()
	local mainGui = playerGui:FindFirstChild("Main")
	if not mainGui then return false, "" end

	local trade = mainGui:FindFirstChild("Trade")
	if not trade or not trade.Visible then return false, "" end

	local cont = trade:FindFirstChild("Container")
	if not cont then return false, "" end

	local f1, f2 = cont:FindFirstChild("1"), cont:FindFirstChild("2")
	if not f1 or not f2 then return false, "" end

	local t1, t2 = f1:FindFirstChild("TextLabel"), f2:FindFirstChild("TextLabel")
	if not t1 or not t2 then return false, "" end

	local ln = string.lower(player.Name)
	local dn = string.lower(player.DisplayName)

	if string.lower(t1.Text) == ln or string.lower(t1.Text) == dn then
		return true, t2.Text
	elseif string.lower(t2.Text) == ln or string.lower(t2.Text) == dn then
		return true, t1.Text
	end

	return false, ""
end

--// Toggle Creator (SLIDER STYLE)
local toggles = {}

local function createToggle(text)
	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(1, 0, 0, 32)
	frame.BackgroundTransparency = 1
	frame.Parent = container

	local label = Instance.new("TextLabel")
	label.Size = UDim2.new(1, -60, 1, 0)
	label.BackgroundTransparency = 1
	label.Text = text
	label.Font = Enum.Font.Gotham
	label.TextSize = 14
	label.TextXAlignment = Left
	label.TextColor3 = Color3.fromRGB(220,220,220)
	label.Parent = frame

	local track = Instance.new("Frame")
	track.Size = UDim2.new(0, 46, 0, 22)
	track.Position = UDim2.new(1, -46, 0.5, -11)
	track.BackgroundColor3 = Color3.fromRGB(60,60,80)
	track.Parent = frame
	Instance.new("UICorner", track).CornerRadius = UDim.new(1,0)

	local knob = Instance.new("Frame")
	knob.Size = UDim2.new(0, 18, 0, 18)
	knob.Position = UDim2.new(0, 2, 0.5, -9)
	knob.BackgroundColor3 = Color3.fromRGB(255,100,100)
	knob.Parent = track
	Instance.new("UICorner", knob).CornerRadius = UDim.new(1,0)

	toggles[text] = false

	track.InputBegan:Connect(function(i)
		if i.UserInputType ~= Enum.UserInputType.MouseButton1 then return end

		local inTrade = checkTradeStatus()
		if not inTrade then return end

		toggles[text] = not toggles[text]

		TweenService:Create(knob, TweenInfo.new(0.25), {
			Position = toggles[text] and UDim2.new(1,-20,0.5,-9) or UDim2.new(0,2,0.5,-9),
			BackgroundColor3 = toggles[text] and Color3.fromRGB(100,255,120) or Color3.fromRGB(255,100,100)
		}):Play()

		TweenService:Create(track, TweenInfo.new(0.25), {
			BackgroundColor3 = toggles[text] and Color3.fromRGB(80,120,90) or Color3.fromRGB(60,60,80)
		}):Play()
	end)
end

createToggle("Freeze Trade")
createToggle("Auto Accept")

--// Status Update
RunService.Heartbeat:Connect(function()
	local inTrade, partner = checkTradeStatus()
	if inTrade then
		status.Text = "Trading with: " .. partner
		status.TextColor3 = Color3.fromRGB(120,255,140)
	else
		status.Text = "Status: Not in trade"
		status.TextColor3 = Color3.fromRGB(200,200,200)
	end
end)
